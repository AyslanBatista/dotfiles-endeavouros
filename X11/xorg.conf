# ============================================================================
# NVIDIA XORG CONFIGURATION - ATUALIZADA
# ============================================================================
# Baseado na sua configuração existente do nvidia-settings
# Modificações:
# 1. DP-2 configurado para 144Hz (estava em 60Hz!)
# 2. ForceCompositionPipeline adicionado (elimina tearing)
# 3. TripleBuffer adicionado (reduz input lag)
# ============================================================================
# LOCALIZAÇÃO: /etc/X11/xorg.conf
# ============================================================================

Section "ServerLayout"
    Identifier     "Layout0"
    Screen      0  "Screen0" 0 0
    InputDevice    "Keyboard0" "CoreKeyboard"
    InputDevice    "Mouse0" "CorePointer"
    Option         "Xinerama" "0"
EndSection

Section "Files"
EndSection

Section "Module"
    Load           "dbe"
    Load           "extmod"
    Load           "type1"
    Load           "freetype"
    Load           "glx"
EndSection

Section "InputDevice"
    # generated from default
    Identifier     "Mouse0"
    Driver         "mouse"
    Option         "Protocol" "auto"
    Option         "Device" "/dev/psaux"
    Option         "Emulate3Buttons" "no"
    Option         "ZAxisMapping" "4 5"
EndSection

Section "InputDevice"
    # generated from default
    Identifier     "Keyboard0"
    Driver         "kbd"
EndSection

Section "Monitor"
    # HorizSync source: edid, VertRefresh source: edid
    Identifier     "Monitor0"
    VendorName     "Unknown"
    ModelName      "AOC 27G2G4"
    HorizSync       160.0 - 160.0
    VertRefresh     48.0 - 144.0
    Option         "DPMS"
EndSection

Section "Device"
    Identifier     "Device0"
    Driver         "nvidia"
    VendorName     "NVIDIA Corporation"
    BoardName      "NVIDIA GeForce GTX 1660 SUPER"
    
    # ========================================================================
    # ADICIONADO: TripleBuffer para reduzir input lag
    # ========================================================================
    Option         "TripleBuffer" "true"
EndSection

Section "Screen"
    Identifier     "Screen0"
    Device         "Device0"
    Monitor        "Monitor0"
    DefaultDepth    24
    Option         "Stereo" "0"
    Option         "nvidiaXineramaInfoOrder" "DP-2"
    
    # ========================================================================
    # MODIFICADO: Metamodes com correções
    # ========================================================================
    # ANTES: "DP-2: 1920x1080_60 +0+0, HDMI-0: 1920x1080_60 +1920+0"
    # DEPOIS:
    # - DP-2 em 144Hz (estava em 60Hz!)
    # - ForceCompositionPipeline em ambos (elimina tearing)
    # - ForceFullCompositionPipeline (sincronização completa)
    # ========================================================================
    Option         "metamodes" "DP-2: 1920x1080_144 +0+0 {ForceCompositionPipeline=On, ForceFullCompositionPipeline=On}, HDMI-0: 1920x1080_60 +1920+0 {ForceCompositionPipeline=On, ForceFullCompositionPipeline=On}"
    
    Option         "SLI" "Off"
    Option         "MultiGPU" "Off"
    Option         "BaseMosaic" "off"
    SubSection     "Display"
        Depth       24
    EndSubSection
EndSection
